gWorldS3=[cos(q1).*cos(q3)+(-1).*sin(q1).*sin(q2).*sin(q3),(-1).*cos(q2).*sin(q1) ...
  ,cos(q3).*sin(q1).*sin(q2)+cos(q1).*sin(q3),DX.*(1+(-1).*cos(q1))+DY.* ...
  sin(q1)+(-1).*DY.*cos(q2).*sin(q1)+(-1).*sin(q1).*(DY.*(1+(-1).*cos(q2)) ...
  +DZ.*sin(q2))+sin(q1).*sin(q2).*(DZ.*(1+(-1).*cos(q3))+DX.*sin(q3))+cos( ...
  q1).*(DX.*(1+(-1).*cos(q3))+(-1).*DZ.*sin(q3))+DZ.*(cos(q3).*sin(q1).* ...
  sin(q2)+cos(q1).*sin(q3))+DX.*(cos(q1).*cos(q3)+(-1).*sin(q1).*sin(q2).* ...
  sin(q3));cos(q3).*sin(q1)+cos(q1).*sin(q2).*sin(q3),cos(q1).*cos(q2),( ...
  -1).*cos(q1).*cos(q3).*sin(q2)+sin(q1).*sin(q3),DY.*(1+(-1).*cos(q1))+ ...
  DY.*cos(q1).*cos(q2)+(-1).*DX.*sin(q1)+cos(q1).*(DY.*(1+(-1).*cos(q2))+ ...
  DZ.*sin(q2))+(-1).*cos(q1).*sin(q2).*(DZ.*(1+(-1).*cos(q3))+DX.*sin(q3)) ...
  +sin(q1).*(DX.*(1+(-1).*cos(q3))+(-1).*DZ.*sin(q3))+DZ.*((-1).*cos(q1).* ...
  cos(q3).*sin(q2)+sin(q1).*sin(q3))+DX.*(cos(q3).*sin(q1)+cos(q1).*sin( ...
  q2).*sin(q3));(-1).*cos(q2).*sin(q3),sin(q2),cos(q2).*cos(q3),DZ.*(1+( ...
  -1).*cos(q2))+DZ.*cos(q2).*cos(q3)+(-1).*DX.*cos(q2).*sin(q3)+cos(q2).*( ...
  DZ.*(1+(-1).*cos(q3))+DX.*sin(q3));0,0,0,1];
