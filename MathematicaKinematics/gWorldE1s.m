gWorldE1=[cos(q1).*cos(q3)+(-1).*sin(q1).*sin(q2).*sin(q3),(-1).*cos(q2).*cos(q4) ...
  .*sin(q1)+(cos(q3).*sin(q1).*sin(q2)+cos(q1).*sin(q3)).*sin(q4),cos(q4) ...
  .*(cos(q3).*sin(q1).*sin(q2)+cos(q1).*sin(q3))+cos(q2).*sin(q1).*sin(q4) ...
  ,DX.*(1+(-1).*cos(q1))+DY.*sin(q1)+(-1).*sin(q1).*(DY.*(1+(-1).*cos(q2)) ...
  +DZ.*sin(q2))+sin(q1).*sin(q2).*(DZ.*(1+(-1).*cos(q3))+DX.*sin(q3))+cos( ...
  q1).*(DX.*(1+(-1).*cos(q3))+(-1).*DZ.*sin(q3))+DX.*(cos(q1).*cos(q3)+( ...
  -1).*sin(q1).*sin(q2).*sin(q3))+(cos(q3).*sin(q1).*sin(q2)+cos(q1).*sin( ...
  q3)).*((DZ+L1).*(1+(-1).*cos(q4))+(-1).*DY.*sin(q4))+(-1).*cos(q2).*sin( ...
  q1).*(DY.*(1+(-1).*cos(q4))+(DZ+L1).*sin(q4))+(DZ+L1).*(cos(q4).*(cos( ...
  q3).*sin(q1).*sin(q2)+cos(q1).*sin(q3))+cos(q2).*sin(q1).*sin(q4))+DY.*( ...
  (-1).*cos(q2).*cos(q4).*sin(q1)+(cos(q3).*sin(q1).*sin(q2)+cos(q1).*sin( ...
  q3)).*sin(q4));cos(q3).*sin(q1)+cos(q1).*sin(q2).*sin(q3),cos(q1).*cos( ...
  q2).*cos(q4)+((-1).*cos(q1).*cos(q3).*sin(q2)+sin(q1).*sin(q3)).*sin(q4) ...
  ,cos(q4).*((-1).*cos(q1).*cos(q3).*sin(q2)+sin(q1).*sin(q3))+(-1).*cos( ...
  q1).*cos(q2).*sin(q4),DY.*(1+(-1).*cos(q1))+(-1).*DX.*sin(q1)+cos(q1).*( ...
  DY.*(1+(-1).*cos(q2))+DZ.*sin(q2))+(-1).*cos(q1).*sin(q2).*(DZ.*(1+(-1) ...
  .*cos(q3))+DX.*sin(q3))+sin(q1).*(DX.*(1+(-1).*cos(q3))+(-1).*DZ.*sin( ...
  q3))+DX.*(cos(q3).*sin(q1)+cos(q1).*sin(q2).*sin(q3))+((-1).*cos(q1).* ...
  cos(q3).*sin(q2)+sin(q1).*sin(q3)).*((DZ+L1).*(1+(-1).*cos(q4))+(-1).* ...
  DY.*sin(q4))+cos(q1).*cos(q2).*(DY.*(1+(-1).*cos(q4))+(DZ+L1).*sin(q4))+ ...
  (DZ+L1).*(cos(q4).*((-1).*cos(q1).*cos(q3).*sin(q2)+sin(q1).*sin(q3))+( ...
  -1).*cos(q1).*cos(q2).*sin(q4))+DY.*(cos(q1).*cos(q2).*cos(q4)+((-1).* ...
  cos(q1).*cos(q3).*sin(q2)+sin(q1).*sin(q3)).*sin(q4));(-1).*cos(q2).* ...
  sin(q3),cos(q4).*sin(q2)+cos(q2).*cos(q3).*sin(q4),cos(q2).*cos(q3).* ...
  cos(q4)+(-1).*sin(q2).*sin(q4),DZ.*(1+(-1).*cos(q2))+(-1).*DY.*sin(q2)+( ...
  -1).*DX.*cos(q2).*sin(q3)+cos(q2).*(DZ.*(1+(-1).*cos(q3))+DX.*sin(q3))+ ...
  cos(q2).*cos(q3).*((DZ+L1).*(1+(-1).*cos(q4))+(-1).*DY.*sin(q4))+sin(q2) ...
  .*(DY.*(1+(-1).*cos(q4))+(DZ+L1).*sin(q4))+DY.*(cos(q4).*sin(q2)+cos(q2) ...
  .*cos(q3).*sin(q4))+(DZ+L1).*(cos(q2).*cos(q3).*cos(q4)+(-1).*sin(q2).* ...
  sin(q4));0,0,0,1];
